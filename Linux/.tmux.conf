# ==============================================================================
# TMUX CONFIGURATION
# ==============================================================================
# Configuration: ~/.tmux.conf
# Description: Beginner-friendly tmux configuration with sensible defaults
# Author: Greg Tate
# Date: November 4, 2025
# ==============================================================================

# ==============================================================================
# QUICK REFERENCE
# ==============================================================================
# Common tmux commands (default prefix is Ctrl+b):
#
# SESSIONS:
#   tmux                        - Start new session
#   tmux new -s name            - Start new session with name
#   tmux attach -t name         - Attach to session with name
#   tmux ls                     - List sessions
#   prefix + d                  - Detach from session
#   prefix + $                  - Rename session
#
# WINDOWS:
#   prefix + c                  - Create new window
#   prefix + ,                  - Rename current window
#   prefix + &                  - Close current window
#   prefix + n                  - Next window
#   prefix + p                  - Previous window
#   prefix + 0-9                - Switch to window by number
#   Shift + Left/Right          - Navigate windows (custom binding)
#
# PANES:
#   prefix + |                  - Split horizontally (custom binding)
#   prefix + -                  - Split vertically (custom binding)
#   prefix + x                  - Close current pane
#   prefix + z                  - Zoom/unzoom pane (fullscreen toggle)
#   prefix + h/j/k/l            - Navigate panes vim-style (custom binding)
#   Alt + Arrow keys            - Navigate panes (custom binding)
#   prefix + H/J/K/L            - Resize panes (custom binding)
#   prefix + {                  - Move pane left
#   prefix + }                  - Move pane right
#
# COPY MODE:
#   prefix + [                  - Enter copy mode
#   v                           - Begin selection (in copy mode)
#   y                           - Copy selection (in copy mode)
#   q or Enter                  - Exit copy mode
#   prefix + ]                  - Paste copied text
#
# OTHER:
#   prefix + ?                  - List all key bindings
#   prefix + r                  - Reload config file (custom binding)
#   prefix + t                  - Show clock
#   prefix + q                  - Show pane numbers
#
# ==============================================================================

# ==============================================================================
# GENERAL SETTINGS
# ==============================================================================
# ------------------------------------------------------------------------------
# Terminal Configuration
# ------------------------------------------------------------------------------
# Use tmux-256color for better compatibility with vim cursor shapes and colors
set-option -g default-terminal "tmux-256color"

# Enable RGB/true color support for Windows Terminal/WSL
set-option -sa terminal-overrides ',xterm-256color:RGB'

# Enable cursor shape changes for vim/neovim (critical for insert mode cursor)
set-option -ga terminal-overrides ',*:Ss=\E[%p1%d q:Se=\E[2 q'

# ------------------------------------------------------------------------------
# Behavior Settings
# ------------------------------------------------------------------------------
# Enable mouse support for scrolling, pane switching, and border resizing
set -g mouse on

# Disable text selection and status bar clicking (keep pane switching, scroll wheel, and border dragging)
unbind -n MouseDown1Status
unbind -n MouseDown3Pane
unbind -n MouseDrag1Pane
unbind -n WheelUpPane
unbind -n WheelDownPane

# Enable single-click to switch panes
bind -n MouseDown1Pane select-pane -t= \; send-keys -M

# Enable scroll wheel for scrolling through terminal history
bind -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'copy-mode -e; send-keys -M'"
bind -n WheelDownPane select-pane -t= \; send-keys -M

# Enable dragging pane borders to resize
bind -n MouseDrag1Border resize-pane -M

# Set escape time to 0 for faster key response (especially in vim)
set -sg escape-time 0

# Enable focus events (useful for vim/neovim)
set -g focus-events on

# Fix backspace key behavior
bind-key -n BSpace send-keys BSpace

# Increase scrollback buffer size (default is 2000)
set -g history-limit 10000

# ------------------------------------------------------------------------------
# Window and Pane Numbering
# ------------------------------------------------------------------------------
# Start window numbering at 1 instead of 0 (easier to reach on keyboard)
set -g base-index 1

# Start pane numbering at 1 instead of 0
setw -g pane-base-index 1

# Automatically renumber windows when one is closed
set -g renumber-windows on

# ==============================================================================
# KEY BINDINGS - PREFIX KEY
# ==============================================================================
# Change prefix from Ctrl+b to backtick ` (doesn't conflict with Vim/Emacs/VS Code)
unbind C-b
set -g prefix `
bind ` send-prefix

# ==============================================================================
# KEY BINDINGS - PANE MANAGEMENT
# ==============================================================================
# ------------------------------------------------------------------------------
# Splitting Panes
# ------------------------------------------------------------------------------
# Split panes using | and - (more intuitive than % and ")
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# ------------------------------------------------------------------------------
# Navigation
# ------------------------------------------------------------------------------
# Switch panes using Alt+arrow without prefix (no prefix needed)
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Vim-style pane navigation (prefix + h/j/k/l)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# ------------------------------------------------------------------------------
# Resizing
# ------------------------------------------------------------------------------
# Resize panes with prefix + H/J/K/L (capital letters)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# ------------------------------------------------------------------------------
# Closing Panes and Windows
# ------------------------------------------------------------------------------
# Close pane without confirmation (prefix + x)
bind x kill-pane

# Close window without confirmation (prefix + &)
bind & kill-window

# ------------------------------------------------------------------------------
# Configuration
# ------------------------------------------------------------------------------
# Reload config file with prefix + r
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# ==============================================================================
# KEY BINDINGS - WINDOW MANAGEMENT
# ==============================================================================
# Create new window with current path
bind c new-window -c "#{pane_current_path}"

# Switch windows with Shift+arrow (no prefix needed)
bind -n S-Left previous-window
bind -n S-Right next-window

# ==============================================================================
# KEY BINDINGS - COPY MODE
# ==============================================================================
# Use vi-style keys in copy mode
setw -g mode-keys vi

# Vi-style copy/paste bindings
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-selection-and-cancel
bind -T copy-mode-vi r send-keys -X rectangle-toggle

# Usage:
#   prefix + [       - Enter copy mode
#   v                - Begin selection
#   y                - Copy selection
#   q or Enter       - Exit copy mode
#   prefix + ]       - Paste copied text

# ==============================================================================
# VISUAL SETTINGS - STATUS BAR
# ==============================================================================
# Status bar position (top or bottom)
set -g status-position top

# Status bar colors
set -g status-bg colour234
set -g status-fg colour137

# Status bar refresh interval (seconds)
set -g status-interval 5

# Center window list in status bar
set -g status-justify centre

# Left side of status bar: Session name and username
set -g status-left '#[fg=colour233,bg=colour245,bold] #S #[fg=colour245,bg=colour234,nobold] #[fg=colour81]#(whoami) #[fg=colour234]'
set -g status-left-length 30

# Right side of status bar: Date and time
set -g status-right '#[fg=colour233,bg=colour245] %b %d %Y #[fg=colour233,bg=colour81,bold] %H:%M '
set -g status-right-length 50

# Window status format
setw -g window-status-format ' #I:#W '
setw -g window-status-current-format '#[fg=colour234,bg=colour81]#[fg=colour234,bg=colour81,bold] #I:#W #[fg=colour81,bg=colour234,nobold]'

# ==============================================================================
# VISUAL SETTINGS - PANES
# ==============================================================================
# Pane border colors
set -g pane-border-style fg=colour238
set -g pane-active-border-style fg=colour81

# Display pane numbers longer (in ms)
set -g display-panes-time 2000

# ==============================================================================
# VISUAL SETTINGS - MESSAGES
# ==============================================================================
# Message colors
set -g message-style bg=colour236,fg=colour81,bold

# Message display time (in ms)
set -g display-time 2000

# ==============================================================================
# ACTIVITY MONITORING
# ==============================================================================
# Highlight window with activity
setw -g monitor-activity on

# Display activity message
set -g visual-activity off
